var I=Object.defineProperty;var M=(o,t,s)=>t in o?I(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var h=(o,t,s)=>(M(o,typeof t!="symbol"?t+"":t,s),s);import{S as N,i as q,s as B,k as j,w as b,a as D,q as E,l as k,m as C,x as v,h as p,c as O,r as P,n as z,b as g,y as _,D as W,I as J,u as L,f as w,t as x,z as T,J as U}from"../../../chunks/index-33d6e1ba.js";import{v as y,P as V,T as A,a as H,b as K,c as Q}from"../../../chunks/index-c8ea7b20.js";class R{constructor(t){h(this,"gravityEnabled");h(this,"dimensions");h(this,"t");h(this,"objects");h(this,"gravity",new y(0,-9.8));h(this,"reporter");h(this,"lastTick");this.gravityEnabled=t.enableGravity??!0,this.dimensions=t.dimensions||new y(100,100),this.objects=[],this.t=0,this.reporter=t.reporter||console.log,this.lastTick=0}addObject(t){this.objects.push(t)}applyGravity(t){t.acceleration.push(this.gravity)}applyDynamics(t){const e=(Date.now()-this.lastTick)/(1e3/60);this.gravityEnabled&&this.applyGravity(t);const a=new y(0,0);for(;t.acceleration.length;){const n=t.acceleration.pop();n&&a.add(n)}a.divideScalar(t.m),t.velocity.add(a.multiplyScalar(e)),t.position.add(t.velocity.clone().multiplyScalar(e))}applyCollisions(t){t.position.x<0&&t.velocity.x<0&&(t.velocity.x*=-.9),t.position.x>this.dimensions.x&&t.velocity.x>0&&(t.velocity.x*=-.9),t.position.y<0&&t.velocity.y<0&&(t.velocity.y*=-.9),t.position.y>this.dimensions.y&&t.velocity.y>0&&(t.velocity.y*=-.9)}step(){this.t===0&&(this.lastTick=Date.now()),this.t++;for(const t of this.objects)t.fixed||(this.applyDynamics(t),this.applyCollisions(t));this.reporter&&this.reporter(this),this.lastTick=Date.now()}}const F=o=>{var t,s;return{geometry:o.geometry,m:o.mass??10,position:((t=o.position)==null?void 0:t.clone())??new y(0,0),velocity:((s=o.velocity)==null?void 0:s.clone())??new y(0,0),acceleration:[],fixed:o.fixed??!1}};function X(o){let t,s,e,a,n=o[0][o[0].length-1]+"",c,f,$,i,l,u,d;return s=new V({props:{sketch:o[2]}}),{c(){t=j("div"),b(s.$$.fragment),e=D(),a=j("p"),c=E(n),f=D(),$=j("button"),i=E("New ball"),this.h()},l(r){t=k(r,"DIV",{class:!0});var m=C(t);v(s.$$.fragment,m),m.forEach(p),e=O(r),a=k(r,"P",{});var S=C(a);c=P(S,n),S.forEach(p),f=O(r),$=k(r,"BUTTON",{});var G=C($);i=P(G,"New ball"),G.forEach(p),this.h()},h(){z(t,"class","d-flex justify-content-center")},m(r,m){g(r,t,m),_(s,t,null),g(r,e,m),g(r,a,m),W(a,c),g(r,f,m),g(r,$,m),W($,i),l=!0,u||(d=J($,"click",o[1]),u=!0)},p(r,[m]){(!l||m&1)&&n!==(n=r[0][r[0].length-1]+"")&&L(c,n)},i(r){l||(w(s.$$.fragment,r),l=!0)},o(r){x(s.$$.fragment,r),l=!1},d(r){r&&p(t),T(s),r&&p(e),r&&p(a),r&&p(f),r&&p($),u=!1,d()}}}function Y(o,t,s){console.clear();let e=[];const a=i=>{const l=i.objects[i.objects.length-1],u=l.position.clone().toFixed(2),d=l.velocity.clone().toFixed(2);e.push(`${i.t} - pos: ${u} - vel: ${d}`),e.length>50&&e.shift(),s(0,e)},n=new R({reporter:a,enableGravity:!1}),c=()=>{for(;n.objects.length;)n.objects.pop();const i=F({geometry:{type:"line",vector:new y(100,0)},position:new y(0,0),fixed:!0});n.addObject(i);for(let l=0;l<1;l++){const u=F({geometry:{type:"sphere",r:5},position:new y(20,50),velocity:new y(Math.random()*5-2.5,Math.random()*20)});n.addObject(u)}};let f;const $=i=>{i.setup=()=>{f=i,i.createCanvas(900,600),i.background(0),i.fill(255),i.stroke(255),c()},i.draw=()=>{i.background(0),n.step();for(const l of n.objects){const u=i.map(l.position.x,0,n.dimensions.x,0,i.width),d=i.map(l.position.y,0,n.dimensions.y,i.height,0);if(l.geometry.type==="sphere"&&(i.strokeWeight(l.geometry.r*2),i.point(u,d)),l.geometry.type==="line"){const r=u+i.map(l.geometry.vector.x,0,n.dimensions.x,0,i.width),m=d+i.map(l.geometry.vector.y,0,n.dimensions.y,0,i.height);i.strokeWeight(2),i.line(u,d,r,m)}}}};return U(()=>{f==null||f.remove()}),[e,c,$]}class Z extends N{constructor(t){super(),q(this,t,Y,X,B,{})}}function tt(o){let t;return{c(){t=E("Test engine")},l(s){t=P(s,"Test engine")},m(s,e){g(s,t,e)},d(s){s&&p(t)}}}function et(o){let t,s;return t=new Q({props:{$$slots:{default:[tt]},$$scope:{ctx:o}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,a){_(t,e,a),s=!0},p(e,a){const n={};a&1&&(n.$$scope={dirty:a,ctx:e}),t.$set(n)},i(e){s||(w(t.$$.fragment,e),s=!0)},o(e){x(t.$$.fragment,e),s=!1},d(e){T(t,e)}}}function st(o){let t,s;return t=new Z({}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,a){_(t,e,a),s=!0},i(e){s||(w(t.$$.fragment,e),s=!0)},o(e){x(t.$$.fragment,e),s=!1},d(e){T(t,e)}}}function nt(o){let t,s,e,a;return t=new H({props:{$$slots:{default:[et]},$$scope:{ctx:o}}}),e=new K({props:{$$slots:{default:[st]},$$scope:{ctx:o}}}),{c(){b(t.$$.fragment),s=D(),b(e.$$.fragment)},l(n){v(t.$$.fragment,n),s=O(n),v(e.$$.fragment,n)},m(n,c){_(t,n,c),g(n,s,c),_(e,n,c),a=!0},p(n,c){const f={};c&1&&(f.$$scope={dirty:c,ctx:n}),t.$set(f);const $={};c&1&&($.$$scope={dirty:c,ctx:n}),e.$set($)},i(n){a||(w(t.$$.fragment,n),w(e.$$.fragment,n),a=!0)},o(n){x(t.$$.fragment,n),x(e.$$.fragment,n),a=!1},d(n){T(t,n),n&&p(s),T(e,n)}}}function it(o){let t,s;return t=new A({props:{$$slots:{default:[nt]},$$scope:{ctx:o}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,a){_(t,e,a),s=!0},p(e,[a]){const n={};a&1&&(n.$$scope={dirty:a,ctx:e}),t.$set(n)},i(e){s||(w(t.$$.fragment,e),s=!0)},o(e){x(t.$$.fragment,e),s=!1},d(e){T(t,e)}}}class lt extends N{constructor(t){super(),q(this,t,null,it,B,{})}}export{lt as default};
